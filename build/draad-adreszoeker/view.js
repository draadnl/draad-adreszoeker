!function(){var e=e||jQuery.noConflict();class t{constructor(e){if(!e)throw new Error("No valid element passed to Draad_Adreszoeker class.");if(this.node=e,this.streetInputNode=this.node.querySelector(".draad-adreszoeker__filter.--street input"),this.streetSuggestionsNode=this.node.querySelector(".draad-adreszoeker__filter.--street .draad-adreszoeker__suggestions"),this.numberInputNode=this.node.querySelector(".draad-adreszoeker__filter.--number input"),this.filterFormNode=this.node.querySelector("form"),this.outputNode=this.node.querySelector(".draad-adreszoeker__output"),!(this.streetInputNode&&this.numberInputNode&&this.filterFormNode&&this.outputNode))throw new Error("Draad_Adreszoeker is missing elements in the DOM.");this.eventBinder()}eventBinder(){this.streetInputNode.addEventListener("input",this.debounce(this.streetHandler,500)),this.filterFormNode.addEventListener("submit",this.handleSubmition.bind(this))}streetHandler=()=>{const t=this.streetInputNode.value.trim(),r=this.streetInputNode.parentNode.querySelectorAll(".draad-adreszoeker__notice");if(r.length>=1)for(const e of r)e.remove();if(t.length<2){this.streetSuggestionsNode.innerHTML="",this.numberInputNode.disabled=!0;const e=document.createElement("span");e.className="draad-adreszoeker__notice",e.textContent="Straatnaam moet minimaal 2 karakters bevatten.",this.streetInputNode.parentNode.appendChild(e)}else this.numberInputNode.disabled=!1;const o=new FormData(this.filterFormNode);e.ajax({url:o.get("admin-ajax"),type:"POST",data:{action:"draad_adreszoeker_get_streets",street:o.get("street")},success:e=>{if(console.log(e),this.streetSuggestionsNode.innerHTML="",!e||e.length<1){const e=document.createElement("option");return e.value="",e.textContent="Geen resultaten gevonden",void this.streetSuggestionsNode.appendChild(e)}e?.forEach((e=>{const t=document.createElement("option");t.value=e.street,t.textContent=e.street,this.streetSuggestionsNode.appendChild(t)}))},error:function(e,t,r){throw new Error(r)}})};async handleSubmition(t){t.preventDefault();const r=new FormData(this.filterFormNode);e.ajax({url:r.get("admin-ajax"),type:"POST",data:{action:r.get("action"),street:r.get("street"),number:r.get("housenumber")},success:e=>{console.log(e),this.outputNode.innerHTML=e.data,this.addNotice("Het advies is geopend.");const t=this.outputNode.querySelector(".draad-adreszoeker__close-advice");t?.addEventListener("click",(e=>{this.outputNode.innerHTML="",this.streetInputNode.value="",this.numberInputNode.value="",this.addNotice("Het advies is gesloten")}))},error:function(e,t,r){throw new Error(r)}})}debounce(e,t){let r;return(...o)=>{clearTimeout(r),r=setTimeout((function(){e.apply(this,o)}),t)}}addNotice(e){const t=this.node.querySelectorAll(":scope > .draad-adreszoeker__notice");if(t.length>=1)for(const e of t)e.remove();const r=document.createElement("span");r.classList.add("draad-adreszoeker__notice"),r.classList.add("sr-only"),r.setAttribute("aria-live","polite"),r.textContent=e,this.node.appendChild(r)}}document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".draad-adreszoeker");e?.forEach((e=>new t(e)))}))}();