!function(){var e=e||jQuery.noConflict();document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".draad-adreszoeker");e?.forEach((e=>new t(e)))}));class t{constructor(e){if(!e)throw new Error("No valid element passed to Draad_Adreszoeker class.");if(this.node=e,this.streetInputNode=this.node.querySelector(".draad-adreszoeker__filter.--street input"),this.streetSuggestionsNode=this.node.querySelector(".draad-adreszoeker__filter.--street .draad-adreszoeker__suggestions"),this.numberInputNode=this.node.querySelector(".draad-adreszoeker__filter.--number input"),this.filterFormNode=this.node.querySelector("form"),this.outputNode=this.node.querySelector(".draad-adreszoeker__output"),!(this.streetInputNode&&this.numberInputNode&&this.filterFormNode&&this.outputNode))throw new Error("Draad_Adreszoeker is missing elements in the DOM.");this.eventBinder()}eventBinder(){this.streetInputNode.addEventListener("input",function(e){let t;return(...s)=>{clearTimeout(t),t=setTimeout((function(){e.apply(this,s)}),500)}}(this.streetHandler)),this.filterFormNode.addEventListener("submit",this.handleSubmition.bind(this))}streetHandler=()=>{const t=this.streetInputNode.value.trim(),s=this.streetInputNode.parentNode.querySelectorAll(".draad-adreszoeker__notice");if(s.length>=1)for(const e of s)e.remove();if(t.length<2){this.streetSuggestionsNode.innerHTML="",this.streetInputNode.setAttribute("aria-invalid","true"),this.numberInputNode.disabled=!0;const e=document.createElement("span");e.className="draad-adreszoeker__notice",e.textContent="Straatnaam moet minimaal 2 karakters bevatten.",e.setAttribute("role","alert"),this.streetInputNode.parentNode.appendChild(e)}else this.streetInputNode.removeAttribute("aria-invalid"),this.numberInputNode.disabled=!1;const r=new FormData(this.filterFormNode);e.ajax({url:r.get("admin-ajax"),type:"POST",data:{action:"draad_adreszoeker_get_streets",street:r.get("street")},success:e=>{const t=e.data;if(this.streetSuggestionsNode.innerHTML="",!t||t.length<=1){const e=document.createElement("option");return e.value="",e.textContent="Geen resultaten gevonden",void this.streetSuggestionsNode.appendChild(e)}"object"==typeof t&&t?.forEach((e=>{const t=document.createElement("option");t.value=e.street,t.textContent=e.street,this.streetSuggestionsNode.appendChild(t)}))},error:function(e,t,s){throw new Error(s)}})};async handleSubmition(t){t.preventDefault();const r=new FormData(this.filterFormNode);e.ajax({url:r.get("admin-ajax"),type:"POST",data:{action:r.get("action"),street:r.get("street"),number:r.get("housenumber")},success:e=>{this.outputNode.innerHTML=e.data,this.addNotice("Het advies is geopend.");const t=this.outputNode.querySelector(".draad-adreszoeker__close-advice");t?.addEventListener("click",(e=>{this.outputNode.innerHTML="",this.streetInputNode.value="",this.numberInputNode.value="",this.addNotice("Het advies is gesloten")})),this.outputNode.querySelectorAll(".draad-tabs__tablist")?.forEach((e=>new s(e)))},error:function(e,t,s){throw new Error(s)}})}addNotice(e){const t=this.node.querySelectorAll(":scope > .draad-adreszoeker__notice");if(t.length>=1)for(const e of t)e.remove();const s=document.createElement("span");s.classList.add("draad-adreszoeker__notice"),s.classList.add("sr-only"),s.setAttribute("aria-live","polite"),s.textContent=e,this.node.appendChild(s)}}class s{constructor(e){if(!e)throw new Error("Draad Tabs: No tablist node provided.");this.tablistNode=e,this.tabs=Array.from(this.tablistNode.querySelectorAll("[role=tab]")),this.tabPanels=this.tabs?.map((e=>document.getElementById(e.getAttribute("aria-controls")))),this.firstTab=this.tabs[0]||null,this.lastTab=this.tabs[this.tabs.length-1]||null,this.tabs?.forEach((e=>{e.setAttribute("aria-selected","false"),e.addEventListener("keydown",this.onKeydown.bind(this)),e.addEventListener("click",this.onClick.bind(this))})),this.setSelectedTab(this.firstTab)}setSelectedTab(e){this.tabs?.forEach(((t,s)=>{const r=t===e;t.setAttribute("aria-selected",r),this.tabPanels[s].hidden=!r}))}moveFocusToTab(e){e.focus()}moveFocusToAdjacentTab(e,t){let s=this.tabs.indexOf(e);s=(s+t+this.tabs.length)%this.tabs.length,this.moveFocusToTab(this.tabs[s])}onKeydown(e){const t=e.currentTarget;let s=!1;switch(e.key){case"ArrowLeft":this.moveFocusToAdjacentTab(t,-1),s=!0;break;case"ArrowRight":this.moveFocusToAdjacentTab(t,1),s=!0;break;case"Home":this.moveFocusToTab(this.firstTab),s=!0;break;case"End":this.moveFocusToTab(this.lastTab),s=!0}s&&e.stopPropagation()}onClick(e){this.setSelectedTab(e.currentTarget)}}}();